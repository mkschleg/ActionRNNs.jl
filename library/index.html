<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>General Documentation · ActionRNNs</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><script src="../../copy.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ActionRNNs</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">ActionRNNs.jl</a></li><li class="is-active"><a class="tocitem" href>General Documentation</a><ul class="internal"><li><a class="tocitem" href="#Contents"><span>Contents</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li><li><a class="tocitem" href="#Cells"><span>Cells</span></a></li><li><a class="tocitem" href="#Other-Layers"><span>Other Layers</span></a></li><li><a class="tocitem" href="#Learning-Updates"><span>Learning Updates</span></a></li><li><a class="tocitem" href="#Constructors"><span>Constructors</span></a></li><li><a class="tocitem" href="#Agents"><span>Agents</span></a></li><li><a class="tocitem" href="#Environments"><span>Environments</span></a></li><li><a class="tocitem" href="#FluxUtils-Stuff"><span>FluxUtils Stuff</span></a></li><li><a class="tocitem" href="#Misc"><span>Misc</span></a></li></ul></li><li><span class="tocitem">Experiment</span><ul><li><a class="tocitem" href="../experiments/ringworld/">RingWorld</a></li><li><a class="tocitem" href="../experiments/directional_tmaze/">Directional TMaze</a></li><li><a class="tocitem" href="../experiments/tmaze/">TMaze</a></li><li><a class="tocitem" href="../experiments/lunarlander/">Lunar Lander</a></li><li><a class="tocitem" href="../experiments/image_dir_tmaze/">Image Directional TMaze</a></li><li><a class="tocitem" href="../experiments/masked_gw/">Masked Grid World</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>General Documentation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>General Documentation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/mkschleg/ActionRNN.jl/blob/master/docs/src/library.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="General-Documentation"><a class="docs-heading-anchor" href="#General-Documentation">General Documentation</a><a id="General-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#General-Documentation" title="Permalink"></a></h1><p>This page hosts the general documentation of the <code>ActionRNNs.jl</code> library. This includes all research code used in this project.</p><h2 id="Contents"><a class="docs-heading-anchor" href="#Contents">Contents</a><a id="Contents-1"></a><a class="docs-heading-anchor-permalink" href="#Contents" title="Permalink"></a></h2><ul><li><a href="#General-Documentation">General Documentation</a></li><li class="no-marker"><ul><li><a href="#Contents">Contents</a></li><li><a href="#Index">Index</a></li><li><a href="#Cells">Cells</a></li><li><a href="#Other-Layers">Other Layers</a></li><li><a href="#Learning-Updates">Learning Updates</a></li><li><a href="#Constructors">Constructors</a></li><li><a href="#Agents">Agents</a></li><li><a href="#Environments">Environments</a></li><li><a href="#FluxUtils-Stuff">FluxUtils Stuff</a></li><li><a href="#Misc">Misc</a></li></ul></li></ul><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#ActionRNNs.MaskedGridWorldHelpers"><code>ActionRNNs.MaskedGridWorldHelpers</code></a></li><li><a href="#ActionRNNs.AbstractActionRNN"><code>ActionRNNs.AbstractActionRNN</code></a></li><li><a href="#ActionRNNs.AbstractERAgent"><code>ActionRNNs.AbstractERAgent</code></a></li><li><a href="#ActionRNNs.ActionDense"><code>ActionRNNs.ActionDense</code></a></li><li><a href="#ActionRNNs.CircularBuffer"><code>ActionRNNs.CircularBuffer</code></a></li><li><a href="#ActionRNNs.DRQNAgent"><code>ActionRNNs.DRQNAgent</code></a></li><li><a href="#ActionRNNs.DRTDNAgent"><code>ActionRNNs.DRTDNAgent</code></a></li><li><a href="#ActionRNNs.DirectionalTMaze"><code>ActionRNNs.DirectionalTMaze</code></a></li><li><a href="#ActionRNNs.ExpUtils.FluxUtils.RMSPropTF"><code>ActionRNNs.ExpUtils.FluxUtils.RMSPropTF</code></a></li><li><a href="#ActionRNNs.ExpUtils.FluxUtils.RMSPropTFCentered"><code>ActionRNNs.ExpUtils.FluxUtils.RMSPropTFCentered</code></a></li><li><a href="#ActionRNNs.HSMinimize"><code>ActionRNNs.HSMinimize</code></a></li><li><a href="#ActionRNNs.HSRefil"><code>ActionRNNs.HSRefil</code></a></li><li><a href="#ActionRNNs.HSStale"><code>ActionRNNs.HSStale</code></a></li><li><a href="#ActionRNNs.LinkedChainsV2"><code>ActionRNNs.LinkedChainsV2</code></a></li><li><a href="#ActionRNNs.LunarLander"><code>ActionRNNs.LunarLander</code></a></li><li><a href="#ActionRNNs.MaskedGridWorld"><code>ActionRNNs.MaskedGridWorld</code></a></li><li><a href="#ActionRNNs.QLearning"><code>ActionRNNs.QLearning</code></a></li><li><a href="#ActionRNNs.RingWorld"><code>ActionRNNs.RingWorld</code></a></li><li><a href="#ActionRNNs.StateBuffer"><code>ActionRNNs.StateBuffer</code></a></li><li><a href="#ActionRNNs.TMaze"><code>ActionRNNs.TMaze</code></a></li><li><a href="#ActionRNNs.UpdateTimer"><code>ActionRNNs.UpdateTimer</code></a></li><li><a href="#ActionRNNs.ϵGreedy"><code>ActionRNNs.ϵGreedy</code></a></li><li><a href="#ActionRNNs.ϵGreedyDecay"><code>ActionRNNs.ϵGreedyDecay</code></a></li><li><a href="#ActionRNNs.AAGRU"><code>ActionRNNs.AAGRU</code></a></li><li><a href="#ActionRNNs.AALSTM"><code>ActionRNNs.AALSTM</code></a></li><li><a href="#ActionRNNs.AARNN"><code>ActionRNNs.AARNN</code></a></li><li><a href="#ActionRNNs.ActionGatedRNN"><code>ActionRNNs.ActionGatedRNN</code></a></li><li><a href="#ActionRNNs.CaddAAGRU"><code>ActionRNNs.CaddAAGRU</code></a></li><li><a href="#ActionRNNs.CaddElGRU"><code>ActionRNNs.CaddElGRU</code></a></li><li><a href="#ActionRNNs.CaddElRNN"><code>ActionRNNs.CaddElRNN</code></a></li><li><a href="#ActionRNNs.CaddGRU"><code>ActionRNNs.CaddGRU</code></a></li><li><a href="#ActionRNNs.CaddMAGRU"><code>ActionRNNs.CaddMAGRU</code></a></li><li><a href="#ActionRNNs.CaddRNN"><code>ActionRNNs.CaddRNN</code></a></li><li><a href="#ActionRNNs.CcatGRU"><code>ActionRNNs.CcatGRU</code></a></li><li><a href="#ActionRNNs.CcatRNN"><code>ActionRNNs.CcatRNN</code></a></li><li><a href="#ActionRNNs.CsoftmaxElGRU"><code>ActionRNNs.CsoftmaxElGRU</code></a></li><li><a href="#ActionRNNs.CsoftmaxElRNN"><code>ActionRNNs.CsoftmaxElRNN</code></a></li><li><a href="#ActionRNNs.ExpUtils.FluxUtils.get_optimizer"><code>ActionRNNs.ExpUtils.FluxUtils.get_optimizer</code></a></li><li><a href="#ActionRNNs.FacMAGRU"><code>ActionRNNs.FacMAGRU</code></a></li><li><a href="#ActionRNNs.FacMARNN"><code>ActionRNNs.FacMARNN</code></a></li><li><a href="#ActionRNNs.FacTucMAGRU"><code>ActionRNNs.FacTucMAGRU</code></a></li><li><a href="#ActionRNNs.FacTucMARNN"><code>ActionRNNs.FacTucMARNN</code></a></li><li><a href="#ActionRNNs.GAIAGRU"><code>ActionRNNs.GAIAGRU</code></a></li><li><a href="#ActionRNNs.GAIALSTM"><code>ActionRNNs.GAIALSTM</code></a></li><li><a href="#ActionRNNs.GAIARNN"><code>ActionRNNs.GAIARNN</code></a></li><li><a href="#ActionRNNs.GAIGRU"><code>ActionRNNs.GAIGRU</code></a></li><li><a href="#ActionRNNs.GAUGRU"><code>ActionRNNs.GAUGRU</code></a></li><li><a href="#ActionRNNs.MAGRU"><code>ActionRNNs.MAGRU</code></a></li><li><a href="#ActionRNNs.MALSTM"><code>ActionRNNs.MALSTM</code></a></li><li><a href="#ActionRNNs.MARNN"><code>ActionRNNs.MARNN</code></a></li><li><a href="#ActionRNNs.MixElGRU"><code>ActionRNNs.MixElGRU</code></a></li><li><a href="#ActionRNNs.MixElRNN"><code>ActionRNNs.MixElRNN</code></a></li><li><a href="#ActionRNNs.MixGRU"><code>ActionRNNs.MixGRU</code></a></li><li><a href="#ActionRNNs.MixRNN"><code>ActionRNNs.MixRNN</code></a></li><li><a href="#ActionRNNs._needs_action_input"><code>ActionRNNs._needs_action_input</code></a></li><li><a href="#ActionRNNs.build_gating_network"><code>ActionRNNs.build_gating_network</code></a></li><li><a href="#ActionRNNs.build_new_feat"><code>ActionRNNs.build_new_feat</code></a></li><li><a href="#ActionRNNs.build_rnn_layer"><code>ActionRNNs.build_rnn_layer</code></a></li><li><a href="#ActionRNNs.capacity"><code>ActionRNNs.capacity</code></a></li><li><a href="#ActionRNNs.contains_comp"><code>ActionRNNs.contains_comp</code></a></li><li><a href="#ActionRNNs.contains_layer_type"><code>ActionRNNs.contains_layer_type</code></a></li><li><a href="#ActionRNNs.contains_rnn_type"><code>ActionRNNs.contains_rnn_type</code></a></li><li><a href="#ActionRNNs.find_layers_with_eq"><code>ActionRNNs.find_layers_with_eq</code></a></li><li><a href="#ActionRNNs.find_layers_with_recur"><code>ActionRNNs.find_layers_with_recur</code></a></li><li><a href="#ActionRNNs.get_action_and_prob"><code>ActionRNNs.get_action_and_prob</code></a></li><li><a href="#ActionRNNs.get_device"><code>ActionRNNs.get_device</code></a></li><li><a href="#ActionRNNs.get_hs_details_for_er"><code>ActionRNNs.get_hs_details_for_er</code></a></li><li><a href="#ActionRNNs.get_hs_from_experience!"><code>ActionRNNs.get_hs_from_experience!</code></a></li><li><a href="#ActionRNNs.get_hs_replay_strategy"><code>ActionRNNs.get_hs_replay_strategy</code></a></li><li><a href="#ActionRNNs.get_hs_symbol_list"><code>ActionRNNs.get_hs_symbol_list</code></a></li><li><a href="#ActionRNNs.get_information_from_experience"><code>ActionRNNs.get_information_from_experience</code></a></li><li><a href="#ActionRNNs.get_learning_update"><code>ActionRNNs.get_learning_update</code></a></li><li><a href="#ActionRNNs.get_model"><code>ActionRNNs.get_model</code></a></li><li><a href="#ActionRNNs.get_prob"><code>ActionRNNs.get_prob</code></a></li><li><a href="#ActionRNNs.get_replay"><code>ActionRNNs.get_replay</code></a></li><li><a href="#ActionRNNs.get_state_from_experience"><code>ActionRNNs.get_state_from_experience</code></a></li><li><a href="#ActionRNNs.hs_symbol_layer"><code>ActionRNNs.hs_symbol_layer</code></a></li><li><a href="#ActionRNNs.make_obs_list"><code>ActionRNNs.make_obs_list</code></a></li><li><a href="#ActionRNNs.make_replay"><code>ActionRNNs.make_replay</code></a></li><li><a href="#ActionRNNs.modify_hs_in_er!"><code>ActionRNNs.modify_hs_in_er!</code></a></li><li><a href="#ActionRNNs.modify_hs_in_er_by_grad!"><code>ActionRNNs.modify_hs_in_er_by_grad!</code></a></li><li><a href="#ActionRNNs.needs_action_input"><code>ActionRNNs.needs_action_input</code></a></li><li><a href="#ActionRNNs.reset!"><code>ActionRNNs.reset!</code></a></li><li><a href="#ActionRNNs.sample"><code>ActionRNNs.sample</code></a></li><li><a href="#ActionRNNs.set_training_mode!"><code>ActionRNNs.set_training_mode!</code></a></li><li><a href="#ActionRNNs.training_mode"><code>ActionRNNs.training_mode</code></a></li><li><a href="#ActionRNNs.update!"><code>ActionRNNs.update!</code></a></li><li><a href="#ActionRNNs.update!-Tuple{ActionRNNs.AbstractERAgent{&lt;:ActionRNNs.ControlUpdate}, Any}"><code>ActionRNNs.update!</code></a></li><li><a href="#ActionRNNs.update!-Tuple{ActionRNNs.AbstractERAgent{&lt;:ActionRNNs.PredictionUpdate}, Any}"><code>ActionRNNs.update!</code></a></li><li><a href="#ActionRNNs.update_target_network!"><code>ActionRNNs.update_target_network!</code></a></li><li><a href="#Base.length-Tuple{ActionRNNs.CircularBuffer}"><code>Base.length</code></a></li><li><a href="#Base.push!-Union{Tuple{CB}, Tuple{CB, NamedTuple}} where CB&lt;:ActionRNNs.CircularBuffer"><code>Base.push!</code></a></li><li><a href="#HelpfulKernelFuncs.contract_WA"><code>HelpfulKernelFuncs.contract_WA</code></a></li><li><a href="#HelpfulKernelFuncs.get_waa"><code>HelpfulKernelFuncs.get_waa</code></a></li><li><a href="#MinimalRLCore.start!-Tuple{ActionRNNs.AbstractERAgent, Any, Any}"><code>MinimalRLCore.start!</code></a></li><li><a href="#MinimalRLCore.step!"><code>MinimalRLCore.step!</code></a></li><li><a href="#MinimalRLCore.step!-Tuple{ActionRNNs.AbstractERAgent, Any, Any, Any, Any}"><code>MinimalRLCore.step!</code></a></li></ul><h2 id="Cells"><a class="docs-heading-anchor" href="#Cells">Cells</a><a id="Cells-1"></a><a class="docs-heading-anchor-permalink" href="#Cells" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.AbstractActionRNN" href="#ActionRNNs.AbstractActionRNN"><code>ActionRNNs.AbstractActionRNN</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractActionRNN</code></pre><p>An abstract struct which will take the current hidden state and  a tuple of observations and actions and returns the next hidden state.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/RNNs.jl#L10-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs._needs_action_input" href="#ActionRNNs._needs_action_input"><code>ActionRNNs._needs_action_input</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">_needs_action_input</code></pre><p>If true, this means the cell or layer needs a tuple as input.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/RNNs.jl#L18-L22">source</a></section></article><h3 id="Basic-Cells"><a class="docs-heading-anchor" href="#Basic-Cells">Basic Cells</a><a id="Basic-Cells-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Cells" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.AARNN" href="#ActionRNNs.AARNN"><code>ActionRNNs.AARNN</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AARNN(in::Integer, actions::Integer, out::Integer, σ = tanh)</code></pre><p>Like an RNN cell, except takes a tuple (action, observation) as input. The action is used with <a href="#HelpfulKernelFuncs.get_waa"><code>get_waa</code></a> with results added to the usual update.</p><p>The update is as follows:     <code>σ.(Wi*o .+ get_waa(Wa, a) .+ Wh*h .+ b)</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/rnns/RNN.jl#L49-L56">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.AAGRU" href="#ActionRNNs.AAGRU"><code>ActionRNNs.AAGRU</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AAGRU(in, actions, out)</code></pre><p>Additive Action Gated Recurrent Unit layer. Behaves like an <a href="#ActionRNNs.AARNN"><code>AARNN</code></a> but uses a GRU internal structure</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/rnns/GRU.jl#L42-L46">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.AALSTM" href="#ActionRNNs.AALSTM"><code>ActionRNNs.AALSTM</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">AALSTM(in::Integer, na::Integer, out::Integer)</code></pre><p><a href="https://www.researchgate.net/publication/13853244_Long_Short-term_Memory">Additive Action Long Short Term Memory</a> recurrent layer. Behaves like an RNN but generally exhibits a longer memory span over sequences. See <a href="https://colah.github.io/posts/2015-08-Understanding-LSTMs/">this article</a> for a good overview of the internals.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/rnns/LSTM.jl#L48-L54">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.MARNN" href="#ActionRNNs.MARNN"><code>ActionRNNs.MARNN</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">MARNN(in::Integer, actions::Integer, out::Integer, σ = tanh)</code></pre><p>This cell incorporates the action as a multiplicative operation. We use  <a href="#HelpfulKernelFuncs.contract_WA"><code>contract_WA</code></a> and <a href="#HelpfulKernelFuncs.get_waa"><code>get_waa</code></a> to handle this.</p><p>The update is as follows:</p><pre><code class="language-julia hljs">new_h = σ.(contract_WA(m.Wx, a, o) .+ contract_WA(m.Wh, a, h) .+ get_waa(m.b, a))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/rnns/RNN.jl#L105-L114">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.MAGRU" href="#ActionRNNs.MAGRU"><code>ActionRNNs.MAGRU</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">MAGRU(in, actions, out)</code></pre><p>Multiplicative Action Gated Recurrent Unit layer. Behaves like an <a href="#ActionRNNs.MARNN"><code>MARNN</code></a> but uses a GRU internal structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/rnns/GRU.jl#L87-L91">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.MALSTM" href="#ActionRNNs.MALSTM"><code>ActionRNNs.MALSTM</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">MALSTM(in::Integer, na::Integer, out::Integer)</code></pre><p><a href="https://www.researchgate.net/publication/13853244_Long_Short-term_Memory">Muliplicative Action Long Short Term Memory</a> recurrent layer. Behaves like an RNN but generally exhibits a longer memory span over sequences. See <a href="https://colah.github.io/posts/2015-08-Understanding-LSTMs/">this article</a> for a good overview of the internals.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/rnns/LSTM.jl#L102-L108">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.FacMARNN" href="#ActionRNNs.FacMARNN"><code>ActionRNNs.FacMARNN</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">FacMARNN(in::Integer, actions::Integer, out::Integer, factors, σ = tanh; init_style=&quot;ignore&quot;)</code></pre><p>This cell incorporates the action as a multiplicative operation, but as a factored approximation of the multiplicative version. This cell uses <a href="#HelpfulKernelFuncs.get_waa"><code>get_waa</code></a>. Uses <a href="https://en.wikipedia.org/wiki/Tensor_rank_decomposition">CP decomposition</a>.</p><p>The update is as follows:</p><pre><code class="language-julia hljs">   new_h = m.σ.(W*((Wx*o .+ Wh*h) .* get_waa(Wa, a)) .+ get_waa(m.b, a))</code></pre><p>Three init_styles:</p><ul><li>standard: using init and initb w/o any keywords</li><li>ignore: <code>W = init(out, factors, ignore_dims=2)</code></li><li>tensor: Decompose <code>W_t = init(actions, out, in+out; ignore_dims=1)</code> to get <code>W_o, W_a, W_hi</code> using <code>TensorToolbox.cp_als</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/rnns/RNN.jl#L193-L209">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.FacMAGRU" href="#ActionRNNs.FacMAGRU"><code>ActionRNNs.FacMAGRU</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">FacMAGRU(in, actions, out, factors)</code></pre><p>Factored Multiplicative Action Gated Recurrent Unit layer. Behaves like an <a href="#ActionRNNs.FacMARNN"><code>FacMARNN</code></a> but uses a GRU internal structure.</p><p>Three init_styles:</p><ul><li>standard: using init and initb w/o any keywords</li><li>ignore: <code>W = init(out, factors, ignore_dims=2)</code></li><li>tensor: Decompose <code>W_t = init(actions, out, in+out; ignore_dims=1)</code> to get <code>W_o, W_a, W_hi</code> using <code>TensorToolbox.cp_als</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/rnns/GRU.jl#L170-L180">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.FacTucMARNN" href="#ActionRNNs.FacTucMARNN"><code>ActionRNNs.FacTucMARNN</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">FacTucMARNN(in::Integer, actions::Integer, out::Integer, action_factors, out_factors, in_factors, σ = tanh; init_style=&quot;ignore&quot;)</code></pre><p>This cell incorporates the action as a multiplicative operation, but as a factored approximation of the multiplicative version. This cell uses <a href="#HelpfulKernelFuncs.get_waa"><code>get_waa</code></a>. Uses <a href="https://en.wikipedia.org/wiki/Tucker_decomposition">Tucker decomposition</a>.</p><p>Three init_styles:</p><ul><li>standard: using init and initb w/o any keywords</li><li>ignore: <code>Wa = init(action_factors, actions; ignore_dims=2)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/rnns/RNN.jl#L276-L285">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.FacTucMAGRU" href="#ActionRNNs.FacTucMAGRU"><code>ActionRNNs.FacTucMAGRU</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">FacTucMAGRU(in, actions, out, factors)</code></pre><p>Factored Multiplicative Action Gated Recurrent Unit layer. Behaves like an <a href="#ActionRNNs.FacTucMARNN"><code>FacTucMARNN</code></a> but uses a GRU internal structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/rnns/GRU.jl#L248-L252">source</a></section></article><h3 id="Combo-Cells"><a class="docs-heading-anchor" href="#Combo-Cells">Combo Cells</a><a id="Combo-Cells-1"></a><a class="docs-heading-anchor-permalink" href="#Combo-Cells" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.CaddRNN" href="#ActionRNNs.CaddRNN"><code>ActionRNNs.CaddRNN</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">CaddRNN(in, actions, out, σ = tanh)</code></pre><p>Mixing between <a href="#ActionRNNs.AARNN"><code>AARNN</code></a> and <a href="#ActionRNNs.MARNN"><code>MARNN</code></a> through a weighting</p><pre><code class="language-julia hljs">h′ = (w[1]*new_hAA + w[2]*new_hMA) ./ sum(w)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/rnns/RNNCombo.jl#L77-L86">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.CaddGRU" href="#ActionRNNs.CaddGRU"><code>ActionRNNs.CaddGRU</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">CaddGRU(in, actions, out, σ = tanh)</code></pre><p>Mixing between <a href="#ActionRNNs.AAGRU"><code>AAGRU</code></a> and <a href="#ActionRNNs.MAGRU"><code>MAGRU</code></a> through a weighting</p><pre><code class="language-julia hljs">h′ = (w[1]*new_hAA + w[2]*new_hMA) ./ sum(w)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/rnns/GRUCombo.jl#L76-L85">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.CaddAAGRU" href="#ActionRNNs.CaddAAGRU"><code>ActionRNNs.CaddAAGRU</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">CaddAAGRU(in, actions, out)</code></pre><p>Mixing between two <a href="#ActionRNNs.AAGRU"><code>AAGRU</code></a> cells through weighting</p><p>```julia h′ = (w[1]<em>new_hAA1 + w[2]</em>new_hAA2) ./ sum(w)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/rnns/GRUCombo.jl#L244-L251">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.CaddMAGRU" href="#ActionRNNs.CaddMAGRU"><code>ActionRNNs.CaddMAGRU</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">CaddMAGRU(in, actions, out)</code></pre><p>Mixing between two <a href="#ActionRNNs.MAGRU"><code>MAGRU</code></a> cells through weighting</p><p>```julia h′ = (w[1]<em>new_hMA1 + w[2]</em>new_hMA2) ./ sum(w)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/rnns/GRUCombo.jl#L320-L327">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.CaddElRNN" href="#ActionRNNs.CaddElRNN"><code>ActionRNNs.CaddElRNN</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">CaddElRNN(in, actions, out, σ = tanh)</code></pre><p>Mixing between <a href="#ActionRNNs.AARNN"><code>AARNN</code></a> and <a href="#ActionRNNs.MARNN"><code>MARNN</code></a> through a weighting</p><pre><code class="language-julia hljs">h′ = (AA_θ .* AA_h′ .+ MA_θ .* MA_h′) ./ (AA_θ .+ MA_θ)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/rnns/RNNCombo.jl#L252-L260">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.CaddElGRU" href="#ActionRNNs.CaddElGRU"><code>ActionRNNs.CaddElGRU</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">CaddElGRU(in, actions, out)</code></pre><p>Mixing between <a href="#ActionRNNs.AAGRU"><code>AAGRU</code></a> and <a href="#ActionRNNs.MAGRU"><code>MAGRU</code></a> through a weighting</p><pre><code class="language-julia hljs">h′ = (AA_θ .* AA_h′ .+ MA_θ .* MA_h′) ./ (AA_θ .+ MA_θ)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/rnns/GRUCombo.jl#L160-L169">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.CcatRNN" href="#ActionRNNs.CcatRNN"><code>ActionRNNs.CcatRNN</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">CcatRNN(in, actions, out, σ = tanh)</code></pre><p>Mixing between <a href="#ActionRNNs.AARNN"><code>AARNN</code></a> and <a href="#ActionRNNs.MARNN"><code>MARNN</code></a> through</p><pre><code class="language-julia hljs">h′ = cat(AA_h′, MA_h′)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/rnns/RNNCombo.jl#L158-L167">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.CcatGRU" href="#ActionRNNs.CcatGRU"><code>ActionRNNs.CcatGRU</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">CcatRNN(in, actions, out)</code></pre><p>Mixing between <a href="#ActionRNNs.AAGRU"><code>AAGRU</code></a> and <a href="#ActionRNNs.MAGRU"><code>MAGRU</code></a> through</p><pre><code class="language-julia hljs">h′ = cat(AA_h′, MA_h′)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/rnns/GRUCombo.jl#L397-L406">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.CsoftmaxElRNN" href="#ActionRNNs.CsoftmaxElRNN"><code>ActionRNNs.CsoftmaxElRNN</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">CaddElRNN(in, actions, out, σ = tanh)</code></pre><p>Mixing between <a href="#ActionRNNs.AARNN"><code>AARNN</code></a> and <a href="#ActionRNNs.MARNN"><code>MARNN</code></a> through a weighting</p><pre><code class="language-julia hljs">h′ = (AA_θ .* AA_h′ .+ MA_θ .* MA_h′) ./ (AA_θ .+ MA_θ)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/rnns/combo_cells_softmax.jl#L79-L87">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.CsoftmaxElGRU" href="#ActionRNNs.CsoftmaxElGRU"><code>ActionRNNs.CsoftmaxElGRU</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">CaddElGRU(in, actions, out)</code></pre><p>Mixing between <a href="#ActionRNNs.AAGRU"><code>AAGRU</code></a> and <a href="#ActionRNNs.MAGRU"><code>MAGRU</code></a> through a weighting</p><pre><code class="language-julia hljs">h′ = (AA_θ .* AA_h′ .+ MA_θ .* MA_h′) ./ (AA_θ .+ MA_θ)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/rnns/combo_cells_softmax.jl#L164-L173">source</a></section></article><h3 id="Mixed-Cells"><a class="docs-heading-anchor" href="#Mixed-Cells">Mixed Cells</a><a id="Mixed-Cells-1"></a><a class="docs-heading-anchor-permalink" href="#Mixed-Cells" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.MixRNN" href="#ActionRNNs.MixRNN"><code>ActionRNNs.MixRNN</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">MixRNN(in, actions, out, num_experts, σ = tanh)</code></pre><p>Mixing between <code>num_experts</code> <a href="#ActionRNNs.AARNN"><code>AARNN</code></a> cells. Uses the weighting</p><pre><code class="language-julia hljs">h′ = sum(θ[i] .* expert_h′[i] for i in 1:length(θ)) ./ sum(θ)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/rnns/mixture_rnns.jl#L67-L76">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.MixElRNN" href="#ActionRNNs.MixElRNN"><code>ActionRNNs.MixElRNN</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">MixElRNN(in, actions, out, num_experts, σ = tanh)</code></pre><p>Mixing between <code>num_experts</code> <a href="#ActionRNNs.AARNN"><code>AARNN</code></a> cells. Uses the weighting</p><pre><code class="language-julia hljs">h′ = sum(θ[i] .* expert_h′[i] for i in 1:length(θ)) ./ sum(θ)</code></pre><p>(here θ[i] is a vector).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/rnns/mixture_rnns.jl#L134-L145">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.MixGRU" href="#ActionRNNs.MixGRU"><code>ActionRNNs.MixGRU</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">MixGRU(in, actions, out, num_experts)</code></pre><p>Mixing between <code>num_experts</code> <a href="#ActionRNNs.AAGRU"><code>AAGRU</code></a> cells. Uses the weighting</p><pre><code class="language-julia hljs">h′ = sum(θ[i] .* expert_h′[i] for i in 1:length(θ)) ./ sum(θ)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/rnns/mixture_grus.jl#L70-L79">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.MixElGRU" href="#ActionRNNs.MixElGRU"><code>ActionRNNs.MixElGRU</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">MixElGRU(in, actions, out, num_experts)</code></pre><p>Mixing between <code>num_experts</code> <a href="#ActionRNNs.AAGRU"><code>AAGRU</code></a> cells. Uses the weighting</p><pre><code class="language-julia hljs">h′ = sum(θ[i] .* expert_h′[i] for i in 1:length(θ)) ./ sum(θ)</code></pre><p>(here <code>θ[i]</code> is a vector).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/rnns/mixture_grus.jl#L133-L143">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.ActionGatedRNN" href="#ActionRNNs.ActionGatedRNN"><code>ActionRNNs.ActionGatedRNN</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">ActionGatedRNN(in::Integer, na, internal, out::Integer, σ = tanh)</code></pre><p>The most basic recurrent layer; essentially acts as a <code>Dense</code> layer, but with the output fed back into the input each time step.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/rnns/ActionGated.jl#L43-L47">source</a></section></article><h3 id="Old/DefunctCells"><a class="docs-heading-anchor" href="#Old/DefunctCells">Old/DefunctCells</a><a id="Old/DefunctCells-1"></a><a class="docs-heading-anchor-permalink" href="#Old/DefunctCells" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.GAUGRU" href="#ActionRNNs.GAUGRU"><code>ActionRNNs.GAUGRU</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">GAUGRU(in::Integer, na::Integer, internal::Integer, out::Integer)</code></pre><p><a href="https://arxiv.org/abs/1406.1078">Gated Action Input Gated Recurrent Unit</a> layer. Behaves like an RNN but generally exhibits a longer memory span over sequences. See <a href="https://colah.github.io/posts/2015-08-Understanding-LSTMs/">this article</a> for a good overview of the internals.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/rnns/ActionGated.jl#L269-L275">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.GAIGRU" href="#ActionRNNs.GAIGRU"><code>ActionRNNs.GAIGRU</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">GAIGRU(in::Integer, na::Integer, internal::Integer, out::Integer)</code></pre><p><a href="https://arxiv.org/abs/1406.1078">Gated Action Input Gated Recurrent Unit</a> layer. Behaves like an RNN but generally exhibits a longer memory span over sequences. See <a href="https://colah.github.io/posts/2015-08-Understanding-LSTMs/">this article</a> for a good overview of the internals.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/rnns/ActionGated.jl#L154-L160">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.GAIARNN" href="#ActionRNNs.GAIARNN"><code>ActionRNNs.GAIARNN</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">GAIARNN(in::Integer, na, internal, out::Integer, σ = tanh)</code></pre><p>The most basic recurrent layer; essentially acts as a <code>Dense</code> layer, but with the output fed back into the input each time step.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/rnns/ActionGated.jl#L91-L95">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.GAIAGRU" href="#ActionRNNs.GAIAGRU"><code>ActionRNNs.GAIAGRU</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">GAIAGRU(in::Integer, na::Integer, internal::Integer, out::Integer)</code></pre><p><a href="https://arxiv.org/abs/1406.1078">Gated Action Input Gated Recurrent Unit</a> layer. Behaves like an RNN but generally exhibits a longer memory span over sequences. See <a href="https://colah.github.io/posts/2015-08-Understanding-LSTMs/">this article</a> for a good overview of the internals.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/rnns/ActionGated.jl#L221-L227">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.GAIALSTM" href="#ActionRNNs.GAIALSTM"><code>ActionRNNs.GAIALSTM</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">GAIALSTM(in::Integer, na::Integer, out::Integer)</code></pre><p><a href="https://www.researchgate .net/publication/13853244_Long_Short-term_Memory">Gated Action Input by Action Long Short Term Memory</a> recurrent layer. Behaves like an RNN but generally exhibits a longer memory span over sequences. See <a href="https://colah.github.io/posts/2015-08-Understanding-LSTMs/">this article</a> for a good overview of the internals.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/rnns/ActionGated.jl#L334-L341">source</a></section></article><h3 id="Shared-operations-for-cells"><a class="docs-heading-anchor" href="#Shared-operations-for-cells">Shared operations for cells</a><a id="Shared-operations-for-cells-1"></a><a class="docs-heading-anchor-permalink" href="#Shared-operations-for-cells" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="HelpfulKernelFuncs.contract_WA" href="#HelpfulKernelFuncs.contract_WA"><code>HelpfulKernelFuncs.contract_WA</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">contract_WA(W, a::Int, x)
contract_WA(W, a::AbstractVector{Int}, x)
contract_WA(W, a::AbstractVector{&lt;:AbstractFloat}, x)
contract_WA(W::CuArray, a::AbstractVector{Int}, x)</code></pre><p>This contraction operator will take the weights <code>W</code>, action (or action vector for batches) <code>a</code>, and features. The weight matrix is assumed to be in <code>nactions × out × in</code>.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="HelpfulKernelFuncs.get_waa" href="#HelpfulKernelFuncs.get_waa"><code>HelpfulKernelFuncs.get_waa</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_waa(Wa, a)</code></pre><p>Different ways of handeling geting action value from a set of weights. This operation can be seen as <code>Wa*a</code> where <code>Wa</code> is the weight matrix, and a is the action representation. This is to be used with various cells to incorporate this operation more reliably.</p></div></section></article><h2 id="Other-Layers"><a class="docs-heading-anchor" href="#Other-Layers">Other Layers</a><a id="Other-Layers-1"></a><a class="docs-heading-anchor-permalink" href="#Other-Layers" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.ActionDense" href="#ActionRNNs.ActionDense"><code>ActionRNNs.ActionDense</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ActionDense(in, na, out, σ; init, bias)</code></pre><p>Create an actions Dense layer. This layer takes in a tuple (action, observaiton) and returns the dense layer using and additive approach. This can be used for previous actions or current actions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/action_dense_layer.jl#L17-L21">source</a></section></article><h2 id="Learning-Updates"><a class="docs-heading-anchor" href="#Learning-Updates">Learning Updates</a><a id="Learning-Updates-1"></a><a class="docs-heading-anchor-permalink" href="#Learning-Updates" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.QLearning" href="#ActionRNNs.QLearning"><code>ActionRNNs.QLearning</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">QLearning
QLearningMSE(γ)
QLearningSUM(γ)
QLearningHUBER(γ)</code></pre><p>Watkins q-learning with various loss functions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/update/QLearning.jl#L4-L12">source</a></section></article><h2 id="Constructors"><a class="docs-heading-anchor" href="#Constructors">Constructors</a><a id="Constructors-1"></a><a class="docs-heading-anchor-permalink" href="#Constructors" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.build_rnn_layer" href="#ActionRNNs.build_rnn_layer"><code>ActionRNNs.build_rnn_layer</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">build_rnn_layer(in, actions, out, parsed, rng)</code></pre><p>Build an rnn layer according from parsed. This assumes the <code>&quot;cell&quot;</code> key is in the <code>parsed</code> dict. in, actions, and out are integers. must explicitly pass in a RNG.</p><p>Gets layer constructor from either the ActionRNNs or Flux namespaces.</p><p>Types of build types</p><ul><li><code>BuildActionRNN</code>: <a href="#ActionRNNs.AARNN"><code>AARNN</code></a>, <a href="#ActionRNNs.MARNN"><code>MARNN</code></a>, <a href="#ActionRNNs.AAGRU"><code>AAGRU</code></a>, <a href="#ActionRNNs.MAGRU"><code>MAGRU</code></a>, <a href="#ActionRNNs.AALSTM"><code>AALSTM</code></a>, <a href="#ActionRNNs.MALSTM"><code>MALSTM</code></a></li><li><code>BuildFactored</code>: <a href="#ActionRNNs.FacMARNN"><code>FacMARNN</code></a>, <a href="#ActionRNNs.FacMAGRU"><code>FacMAGRU</code></a></li><li><code>BuildTucFactored</code>: <a href="#ActionRNNs.FacTucMARNN"><code>FacTucMARNN</code></a>, <a href="#ActionRNNs.FacTucMAGRU"><code>FacTucMAGRU</code></a></li><li><code>BuildComboCat</code>: <a href="#ActionRNNs.CcatRNN"><code>CcatRNN</code></a>, <a href="#ActionRNNs.CcatGRU"><code>CcatGRU</code></a></li><li><code>BuildComboAdd</code>: <a href="#ActionRNNs.CaddRNN"><code>CaddRNN</code></a>, <a href="#ActionRNNs.CaddGRU"><code>CaddGRU</code></a>, <a href="#ActionRNNs.CaddAAGRU"><code>CaddAAGRU</code></a>, <a href="#ActionRNNs.CaddMAGRU"><code>CaddMAGRU</code></a>, <a href="#ActionRNNs.CaddElRNN"><code>CaddElRNN</code></a></li><li><code>BuildMixed</code>: <a href="#ActionRNNs.MixRNN"><code>MixRNN</code></a>, <a href="#ActionRNNs.MixElRNN"><code>MixElRNN</code></a>, <a href="#ActionRNNs.MixElGRU"><code>MixElGRU</code></a>, <a href="#ActionRNNs.MixGRU"><code>MixGRU</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/construct/rnns.jl#L90-L105">source</a></section><section><div><pre><code class="nohighlight hljs">build_rnn_layer(::BuildActionRNN, args...; kwargs...)</code></pre><p>Standard Additive and Multiplicative cells. No extra parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/construct/rnns.jl#L124-L129">source</a></section><section><div><pre><code class="nohighlight hljs">build_rnn_layer(::BuildFactored, args...; kwargs...)</code></pre><p>Factored (not tucker) cells. <strong>Extra Config Options:</strong></p><ul><li><code>init_style::String</code>: They style of init. Check your cell for possible options.</li><li><code>factors::Int</code>: Number of factors in factorization.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/construct/rnns.jl#L143-L150">source</a></section><section><div><pre><code class="nohighlight hljs">build_rnn_layer(::BuildTucFactored, args...; kwargs...)</code></pre><p>Tucker Factored cells: <strong>Extra Config Options:</strong></p><ul><li><code>in_factors::Int</code>: Number of factors in input matrix</li><li><code>action_factors::Int</code>: Number of factors in action matrix</li><li><code>out_factors::Int</code>: Number of factors in out matrix</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/construct/rnns.jl#L171-L179">source</a></section><section><div><pre><code class="nohighlight hljs">build_rnn_layer(::BuildComboCat, args...; kwargs...)</code></pre><p>Combo cat AA/MA cells. No Extra Params.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/construct/rnns.jl#L205-L209">source</a></section><section><div><pre><code class="nohighlight hljs">build_rnn_layer(::BuildComboAdd, args...; kwargs...)</code></pre><p>Combo add AA/MA cells. No Extra Params.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/construct/rnns.jl#L223-L227">source</a></section><section><div><pre><code class="nohighlight hljs">build_rnn_layer(::BuildMixed, args...; kwargs...)</code></pre><p>Mixed layers. <strong>Extra Config Options</strong> -<code>num_experts::Int</code>: number of parallel cells in mixture.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/construct/rnns.jl#L239-L245">source</a></section><section><div><pre><code class="nohighlight hljs">build_rnn_layer(::BuildFlux, args...; kwargs...)</code></pre><p>Flux cell. No extra parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/construct/rnns.jl#L261-L265">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.build_gating_network" href="#ActionRNNs.build_gating_network"><code>ActionRNNs.build_gating_network</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">build_gating_network

[[out, activation]]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/construct/rnns.jl#L296-L300">source</a></section></article><h2 id="Agents"><a class="docs-heading-anchor" href="#Agents">Agents</a><a id="Agents-1"></a><a class="docs-heading-anchor-permalink" href="#Agents" title="Permalink"></a></h2><h3 id="Experience-Replay-Agents"><a class="docs-heading-anchor" href="#Experience-Replay-Agents">Experience Replay Agents</a><a id="Experience-Replay-Agents-1"></a><a class="docs-heading-anchor-permalink" href="#Experience-Replay-Agents" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.AbstractERAgent" href="#ActionRNNs.AbstractERAgent"><code>ActionRNNs.AbstractERAgent</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractERAgent</code></pre><p>The abstract struct for building experience replay agents.</p><p>example agent: mutable struct DRQNAgent{ER, Φ,  Π, HS&lt;:AbstractMatrix{Float32}} &lt;: AbstractERAgent     lu::LearningUpdate     opt::O     model::C     target_network::CT</p><pre><code class="nohighlight hljs">build_features::F
state_list::DataStructures.CircularBuffer{Φ}

hidden_state_init::Dict{Symbol, HS}

replay::ER
update_timer::UpdateTimer
target_update_timer::UpdateTimer

batch_size::Int
τ::Int

s_t::Φ
π::Π
γ::Float32

action::Int
am1::Int
action_prob::Float64

hs_learnable::Bool
beg::Bool
cur_step::Int

hs_tr_init::Dict{Symbol, HS}</code></pre><p>end</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/agent/AbstractERAgent.jl#L4-L43">source</a></section></article><h4 id="Instantiations"><a class="docs-heading-anchor" href="#Instantiations">Instantiations</a><a id="Instantiations-1"></a><a class="docs-heading-anchor-permalink" href="#Instantiations" title="Permalink"></a></h4><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.DRQNAgent" href="#ActionRNNs.DRQNAgent"><code>ActionRNNs.DRQNAgent</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DRQNAgent</code></pre><p>An intense function... lol.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/agent/DRQNAgent.jl#L68-L72">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.DRTDNAgent" href="#ActionRNNs.DRTDNAgent"><code>ActionRNNs.DRTDNAgent</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Basic DRQNAgent.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/agent/DRTDNAgent.jl#L1-L3">source</a></section></article><h4 id="Implementation-details"><a class="docs-heading-anchor" href="#Implementation-details">Implementation details</a><a id="Implementation-details-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation-details" title="Permalink"></a></h4><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.get_replay" href="#ActionRNNs.get_replay"><code>ActionRNNs.get_replay</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_replay(agent::AbstractERAgent)</code></pre><p>Get the replay buffer from the agent.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/agent/AbstractERAgent.jl#L46-L50">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.get_learning_update" href="#ActionRNNs.get_learning_update"><code>ActionRNNs.get_learning_update</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_learning_update(agent::AbstractERAgent)</code></pre><p>Get the learning update from the agent.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/agent/AbstractERAgent.jl#L53-L57">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.get_device" href="#ActionRNNs.get_device"><code>ActionRNNs.get_device</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_device(agent::AbstractERAgent)</code></pre><p>Get the current device from the agent.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/agent/AbstractERAgent.jl#L60-L64">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.get_action_and_prob" href="#ActionRNNs.get_action_and_prob"><code>ActionRNNs.get_action_and_prob</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_action_and_prob(π, values, rng)</code></pre><p>Get action and the associated probability of taking the action.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/agent/AbstractERAgent.jl#L99-L103">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.get_model" href="#ActionRNNs.get_model"><code>ActionRNNs.get_model</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_model(agent::AbstractERAgent)</code></pre><p>return the model from the agent.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/agent/AbstractERAgent.jl#L74-L78">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MinimalRLCore.start!-Tuple{ActionRNNs.AbstractERAgent, Any, Any}" href="#MinimalRLCore.start!-Tuple{ActionRNNs.AbstractERAgent, Any, Any}"><code>MinimalRLCore.start!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">    MinimalRLCore.start!(agent::AbstractERAgent, s, rng; kwargs...)</code></pre><p>Start the agent for a new episode. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/agent/AbstractERAgent.jl#L117-L121">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MinimalRLCore.step!-Tuple{ActionRNNs.AbstractERAgent, Any, Any, Any, Any}" href="#MinimalRLCore.step!-Tuple{ActionRNNs.AbstractERAgent, Any, Any, Any, Any}"><code>MinimalRLCore.step!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">MinimalRLCore.step!(agent::AbstractERAgent, env_s_tp1, r, terminal, rng; kwargs...)</code></pre><p>step! for an experience replay agent.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/agent/AbstractERAgent.jl#L166-L170">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MinimalRLCore.step!" href="#MinimalRLCore.step!"><code>MinimalRLCore.step!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">MinimalRLCore.step!(agent::AbstractERAgent, env_s_tp1, r, terminal, rng; kwargs...)</code></pre><p>step! for an experience replay agent.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/agent/AbstractERAgent.jl#L166-L170">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.training_mode" href="#ActionRNNs.training_mode"><code>ActionRNNs.training_mode</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">training_mode(agent::AbstractERAgent)</code></pre><p>returns bool whether the agent is in training mode.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/agent/AbstractERAgent.jl#L81-L85">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.set_training_mode!" href="#ActionRNNs.set_training_mode!"><code>ActionRNNs.set_training_mode!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">set_training_mode(agent::AbstractERAgent, mode::Bool)</code></pre><p>sets training mode to boolean value</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/agent/AbstractERAgent.jl#L88-L92">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.update!-Tuple{ActionRNNs.AbstractERAgent{&lt;:ActionRNNs.ControlUpdate}, Any}" href="#ActionRNNs.update!-Tuple{ActionRNNs.AbstractERAgent{&lt;:ActionRNNs.ControlUpdate}, Any}"><code>ActionRNNs.update!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">update!(agent::AbstractERAgent{&lt;:ControlUpdate}, rng)</code></pre><p>Update the parameters of the model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/agent/AbstractERAgent.jl#L248-L252">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.update!-Tuple{ActionRNNs.AbstractERAgent{&lt;:ActionRNNs.PredictionUpdate}, Any}" href="#ActionRNNs.update!-Tuple{ActionRNNs.AbstractERAgent{&lt;:ActionRNNs.PredictionUpdate}, Any}"><code>ActionRNNs.update!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">update!(agent::AbstractERAgent{&lt;:PredictionUpdate}, rng)</code></pre><p>Update the parameters of the model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/agent/AbstractERAgent.jl#L291-L295">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.update!" href="#ActionRNNs.update!"><code>ActionRNNs.update!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">update!(agent::AbstractERAgent{&lt;:ControlUpdate}, rng)</code></pre><p>Update the parameters of the model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/agent/AbstractERAgent.jl#L248-L252">source</a></section><section><div><pre><code class="language-julia hljs">update!(agent::AbstractERAgent{&lt;:PredictionUpdate}, rng)</code></pre><p>Update the parameters of the model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/agent/AbstractERAgent.jl#L291-L295">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.update_target_network!" href="#ActionRNNs.update_target_network!"><code>ActionRNNs.update_target_network!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">update_target_network!</code></pre><p>Update the target network.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/agent/AbstractERAgent.jl#L336-L340">source</a></section></article><h3 id="Online-Agents"><a class="docs-heading-anchor" href="#Online-Agents">Online Agents</a><a id="Online-Agents-1"></a><a class="docs-heading-anchor-permalink" href="#Online-Agents" title="Permalink"></a></h3><h3 id="Tools/Utils"><a class="docs-heading-anchor" href="#Tools/Utils">Tools/Utils</a><a id="Tools/Utils-1"></a><a class="docs-heading-anchor-permalink" href="#Tools/Utils" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.UpdateTimer" href="#ActionRNNs.UpdateTimer"><code>ActionRNNs.UpdateTimer</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">UpdateTimer</code></pre><p>Keeps track of timer for doing things in the agent.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/agent/agent_util.jl#L6-L10">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.make_obs_list" href="#ActionRNNs.make_obs_list"><code>ActionRNNs.make_obs_list</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">make_obs_list</code></pre><p>Makes the obs list and initial state used for recurrent networks in an agent.  Uses an init function to define the init tuple.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/agent/agent_util.jl#L29-L34">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.build_new_feat" href="#ActionRNNs.build_new_feat"><code>ActionRNNs.build_new_feat</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">build_new_feat(agent, state, action)</code></pre><p>convenience for building new feature vector</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/agent/agent_util.jl#L181-L185">source</a></section></article><h5 id="Hidden-state-manipulation"><a class="docs-heading-anchor" href="#Hidden-state-manipulation">Hidden state manipulation</a><a id="Hidden-state-manipulation-1"></a><a class="docs-heading-anchor-permalink" href="#Hidden-state-manipulation" title="Permalink"></a></h5><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.HSStale" href="#ActionRNNs.HSStale"><code>ActionRNNs.HSStale</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">HSStale</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/hs_strategies.jl#L4-L6">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.HSMinimize" href="#ActionRNNs.HSMinimize"><code>ActionRNNs.HSMinimize</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">HSMinimize</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/hs_strategies.jl#L9-L11">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.HSRefil" href="#ActionRNNs.HSRefil"><code>ActionRNNs.HSRefil</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">HSRefil</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/hs_strategies.jl#L14-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.get_hs_replay_strategy" href="#ActionRNNs.get_hs_replay_strategy"><code>ActionRNNs.get_hs_replay_strategy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_hs_replay_strategy(agent::AbstractERAgent)</code></pre><p>Get the replay strategy of the agent.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/agent/AbstractERAgent.jl#L67-L71">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.modify_hs_in_er!" href="#ActionRNNs.modify_hs_in_er!"><code>ActionRNNs.modify_hs_in_er!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">modify_hs_in_er!(hs_strategy::Bool, args...; kwargs...)</code></pre><p>Legacy function for hs_strategy as a boolean.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/hs_strategies.jl#L39-L43">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.modify_hs_in_er_by_grad!" href="#ActionRNNs.modify_hs_in_er_by_grad!"><code>ActionRNNs.modify_hs_in_er_by_grad!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">modify_hs_in_er!</code></pre><p>Updating hidden state in the experience replay buffer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/hs_strategies.jl#L57-L61">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.reset!" href="#ActionRNNs.reset!"><code>ActionRNNs.reset!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">reset!(m, h_init::Dict)
reset!(m::Flux.Recur, h_init)</code></pre><p>Reset the hidden state according to the dict h<em>init with keys from [`get</em>hs<em>symbol</em>list`](@ref). If model is a recur just replace the hidden state. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/RNNUtil.jl#L122-L128">source</a></section></article><h5 id="Replay-buffer"><a class="docs-heading-anchor" href="#Replay-buffer">Replay buffer</a><a id="Replay-buffer-1"></a><a class="docs-heading-anchor-permalink" href="#Replay-buffer" title="Permalink"></a></h5><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.CircularBuffer" href="#ActionRNNs.CircularBuffer"><code>ActionRNNs.CircularBuffer</code></a> — <span class="docstring-category">Type</span></header><section><div><p>CircularBuffer     Maintains a buffer of fixed size w/o reallocating and deallocating memory through a circular queue data struct.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/utils/buffer.jl#L1-L4">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.StateBuffer" href="#ActionRNNs.StateBuffer"><code>ActionRNNs.StateBuffer</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">StateBuffer(size::Int, state_size)</code></pre><p>A cicular buffer for states. Typically used for images, can be used for state shapes up to 4d.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/utils/state_buffer.jl#L5-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.length-Tuple{ActionRNNs.CircularBuffer}" href="#Base.length-Tuple{ActionRNNs.CircularBuffer}"><code>Base.length</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">length(buffer)</code></pre><p>Returns the current amount of data in the circular buffer. If the full flag is true then we return the size of the whole data frame.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/utils/buffer.jl#L84-L89">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.push!-Union{Tuple{CB}, Tuple{CB, NamedTuple}} where CB&lt;:ActionRNNs.CircularBuffer" href="#Base.push!-Union{Tuple{CB}, Tuple{CB, NamedTuple}} where CB&lt;:ActionRNNs.CircularBuffer"><code>Base.push!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">push!(buffer, data)</code></pre><p>Adds data to the buffer, where data is an array of collections of types defined in CircularBuffer.<em>data</em>types returns row of data of added d</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/utils/buffer.jl#L48-L53">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.get_hs_details_for_er" href="#ActionRNNs.get_hs_details_for_er"><code>ActionRNNs.get_hs_details_for_er</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_hs_details_for_er(model)</code></pre><p>Return the types, sizes, and symbols of the hidden state for the ER buffer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/RNNUtil.jl#L212-L216">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.hs_symbol_layer" href="#ActionRNNs.hs_symbol_layer"><code>ActionRNNs.hs_symbol_layer</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">hs_symbol_layer(l, idx)</code></pre><p>Get symbol of current layer&#39;s hidden state layer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/RNNUtil.jl#L86-L90">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.get_hs_symbol_list" href="#ActionRNNs.get_hs_symbol_list"><code>ActionRNNs.get_hs_symbol_list</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_hs_symbol_list(model)</code></pre><p>Get list of hidden state symbols for all rnn layers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/RNNUtil.jl#L97-L101">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.get_state_from_experience" href="#ActionRNNs.get_state_from_experience"><code>ActionRNNs.get_state_from_experience</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_state_from_experiment</code></pre><p>Returns hidden state from experience sampled from an experience replay buffer.  This assumes the replay has <code>(:am1, :s, :a, :sp, :r, :t, :beg, hs_symbol...)</code> as columns.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/agent/agent_util.jl#L69-L74">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.get_information_from_experience" href="#ActionRNNs.get_information_from_experience"><code>ActionRNNs.get_information_from_experience</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_information_from_experience(agent, exp)</code></pre><p>Gets the tuple of required details for the update of the agent. This is dispatched on the type of learning update.  You can use the helper abstract classes, or dispatch for your specific update.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/agent/agent_util.jl#L91-L96">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.make_replay" href="#ActionRNNs.make_replay"><code>ActionRNNs.make_replay</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">make_replay</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/agent/agent_util.jl#L51-L55">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.get_hs_from_experience!" href="#ActionRNNs.get_hs_from_experience!"><code>ActionRNNs.get_hs_from_experience!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_hs_from_experience!(model, exp::NamedTuple, hs_dict::Dict, device)
get_hs_from_experience!(model, exp::Vector, hs_dict::Dict, device)</code></pre><p>Get hs in the appropriate formate from the experience (either a Named Tuple or a vector of tuples Named Tuples).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/RNNUtil.jl#L251-L256">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.capacity" href="#ActionRNNs.capacity"><code>ActionRNNs.capacity</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">capacity(buffer)
returns the max number of elements the buffer can store.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/utils/buffer.jl#L98-L101">source</a></section></article><h5 id="Flux-Chain-Manipulation"><a class="docs-heading-anchor" href="#Flux-Chain-Manipulation">Flux Chain Manipulation</a><a id="Flux-Chain-Manipulation-1"></a><a class="docs-heading-anchor-permalink" href="#Flux-Chain-Manipulation" title="Permalink"></a></h5><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.contains_comp" href="#ActionRNNs.contains_comp"><code>ActionRNNs.contains_comp</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">contains_comp(comp::Function, model)</code></pre><p>Check if a layer of a model returns true with comp.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/RNNUtil.jl#L40-L44">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.find_layers_with_eq" href="#ActionRNNs.find_layers_with_eq"><code>ActionRNNs.find_layers_with_eq</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">find_layers_with_eq(eq::Function, model)</code></pre><p>A function which takes a model and a function and returns the locations where the function returns true. This only supports composing chains twice.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/RNNUtil.jl#L10-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.find_layers_with_recur" href="#ActionRNNs.find_layers_with_recur"><code>ActionRNNs.find_layers_with_recur</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">find_layers_with_recur(model)</code></pre><p>Finds layers with recur. Uses <a href="#ActionRNNs.find_layers_with_eq"><code>find_layers_with_eq</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/RNNUtil.jl#L31-L35">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.contains_rnn_type" href="#ActionRNNs.contains_rnn_type"><code>ActionRNNs.contains_rnn_type</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">contains_rnn_type(m, rnn_type)</code></pre><p>Checks if the model has a specific rnn type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/RNNUtil.jl#L61-L65">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.needs_action_input" href="#ActionRNNs.needs_action_input"><code>ActionRNNs.needs_action_input</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">needs_action_input(m)</code></pre><p>Checks if the model needs action input as a tuple.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/RNNUtil.jl#L74-L78">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.contains_layer_type" href="#ActionRNNs.contains_layer_type"><code>ActionRNNs.contains_layer_type</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">contains_layer_type(model, type)</code></pre><p>Check if the model has a specific layer type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/RNNUtil.jl#L52-L56">source</a></section></article><h3 id="Policies"><a class="docs-heading-anchor" href="#Policies">Policies</a><a id="Policies-1"></a><a class="docs-heading-anchor-permalink" href="#Policies" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.ϵGreedy" href="#ActionRNNs.ϵGreedy"><code>ActionRNNs.ϵGreedy</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ϵGreedy(ϵ, action_set)
ϵGreedy(ϵ, num_actions)</code></pre><p>Simple ϵGreedy value policy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/ActingPolicy.jl#L42-L47">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.ϵGreedyDecay" href="#ActionRNNs.ϵGreedyDecay"><code>ActionRNNs.ϵGreedyDecay</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ϵGreedyDecay{AS}(ϵ_range, decay_period, warmup_steps, action_set::AS)
ϵGreedyDecay(ϵ_range, end_step, num_actions)</code></pre><p>This is an acting policy which decays exploration linearly over time. This api will possibly change overtime once I figure out a better way to specify decaying epsilon.</p><p><strong>Arguments</strong></p><p><code>ϵ_range::Tuple{Float64, Float64}</code>: (max epsilon, min epsilon) <code>decay_period::Int</code>: period epsilon decays <code>warmup_steps::Int</code>: number of steps before decay starts</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/ActingPolicy.jl#L85-L95">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.get_prob" href="#ActionRNNs.get_prob"><code>ActionRNNs.get_prob</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_prob(ap::ϵGreedy, values, action)</code></pre><p>Get probabiliyt of action according to values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/ActingPolicy.jl#L71-L75">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.sample" href="#ActionRNNs.sample"><code>ActionRNNs.sample</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">sample(ap::ϵGreedy, values, rng)</code></pre><p>Select an action according to the values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/ActingPolicy.jl#L57-L61">source</a></section></article><h3 id="Feature-Constructors"><a class="docs-heading-anchor" href="#Feature-Constructors">Feature Constructors</a><a id="Feature-Constructors-1"></a><a class="docs-heading-anchor-permalink" href="#Feature-Constructors" title="Permalink"></a></h3><h2 id="Environments"><a class="docs-heading-anchor" href="#Environments">Environments</a><a id="Environments-1"></a><a class="docs-heading-anchor-permalink" href="#Environments" title="Permalink"></a></h2><h3 id="RingWorld"><a class="docs-heading-anchor" href="#RingWorld">RingWorld</a><a id="RingWorld-1"></a><a class="docs-heading-anchor-permalink" href="#RingWorld" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.RingWorld" href="#ActionRNNs.RingWorld"><code>ActionRNNs.RingWorld</code></a> — <span class="docstring-category">Type</span></header><section><div><p>RingWorld States: 1     2     3     ...     n Vis:    1 &lt;-&gt; 0 &lt;-&gt; 0 &lt;-&gt; ... &lt;-&gt; 0 &lt;-|         ^––––––––––––––-|</p><p>chain_length: size (diameter) of ring actions: Forward of Backward</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/env/RingWorld.jl#L17-L26">source</a></section></article><h3 id="LinkedChains"><a class="docs-heading-anchor" href="#LinkedChains">LinkedChains</a><a id="LinkedChains-1"></a><a class="docs-heading-anchor-permalink" href="#LinkedChains" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.LinkedChainsV2" href="#ActionRNNs.LinkedChainsV2"><code>ActionRNNs.LinkedChainsV2</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LinkedChains</code></pre><p>termmode:</p><ul><li>CONT: No termination</li><li>TERM: Terminate after chain</li></ul><p>dynmode: </p><ul><li>STRAIGHT: high Negative reward on wrong actions, but still progress through chain</li><li>JUMP: Jump to different chain on wrong action</li><li>STUCK: Don&#39;t progress on wrong action</li><li>JUMPSTUCK: Get &quot;lost&quot; with wrong actions, still being implemented.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/env/LinkedChains.jl#L24-L35">source</a></section></article><h3 id="TMaze"><a class="docs-heading-anchor" href="#TMaze">TMaze</a><a id="TMaze-1"></a><a class="docs-heading-anchor-permalink" href="#TMaze" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.TMaze" href="#ActionRNNs.TMaze"><code>ActionRNNs.TMaze</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">TMaze</code></pre><p>TMaze as defined by <a href="https://proceedings.neurips.cc/paper/2001/hash/a38b16173474ba8b1a95bcbc30d3b8a5-Abstract.html">Bram Bakker</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/env/TMaze.jl#L20-L24">source</a></section></article><h3 id="DirectionalTMaze"><a class="docs-heading-anchor" href="#DirectionalTMaze">DirectionalTMaze</a><a id="DirectionalTMaze-1"></a><a class="docs-heading-anchor-permalink" href="#DirectionalTMaze" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.DirectionalTMaze" href="#ActionRNNs.DirectionalTMaze"><code>ActionRNNs.DirectionalTMaze</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DirectionalTMaze</code></pre><p>Similar to <a href="#ActionRNNs.TMaze"><code>ActionRNNs.TMaze</code></a> but with a directional componenet overlayed ontop. This also changes to  observation structure, where the agent must know what direction it is facing to get information about which goal is the good goal.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/env/DirectionalTMaze.jl#L30-L36">source</a></section></article><h3 id="Masked-Grid-World"><a class="docs-heading-anchor" href="#Masked-Grid-World">Masked Grid World</a><a id="Masked-Grid-World-1"></a><a class="docs-heading-anchor-permalink" href="#Masked-Grid-World" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.MaskedGridWorld" href="#ActionRNNs.MaskedGridWorld"><code>ActionRNNs.MaskedGridWorld</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">MaskedGridWorld</code></pre><p>This grid world gives observations on a random number of states which are aliased (or not given obs<em>strategy). This environment also has the pacman</em>wrapping flag which makes it so the edges wrap around.</p><ul><li><code>width::Int</code>: width of gw</li><li><code>height::Int</code>: height of gw</li><li><code>anchors::Int</code>: number of anchors (Int), or list of anchor states</li><li><code>goals_or_rews</code>: number of goals, list of goals, or list of rewards.</li><li><code>obs_strategy</code>: what obs are returned, :seperate, :full, aliased</li><li><code>pacman_wrapping::Bool</code>: whether the walls are invisible and wrap around</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/env/MaskedGridWorld.jl#L75-L86">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.MaskedGridWorldHelpers" href="#ActionRNNs.MaskedGridWorldHelpers"><code>ActionRNNs.MaskedGridWorldHelpers</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">MaskedGridWorldHelpers</code></pre><p>Helper functions for the Masked grid world environment.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/env/MaskedGridWorld.jl#L20-L24">source</a></section></article><h3 id="Lunar-Lander"><a class="docs-heading-anchor" href="#Lunar-Lander">Lunar Lander</a><a id="Lunar-Lander-1"></a><a class="docs-heading-anchor-permalink" href="#Lunar-Lander" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.LunarLander" href="#ActionRNNs.LunarLander"><code>ActionRNNs.LunarLander</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LunarLander</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/env/LunarLander.jl#L9-L11">source</a></section></article><h2 id="FluxUtils-Stuff"><a class="docs-heading-anchor" href="#FluxUtils-Stuff">FluxUtils Stuff</a><a id="FluxUtils-Stuff-1"></a><a class="docs-heading-anchor-permalink" href="#FluxUtils-Stuff" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.ExpUtils.FluxUtils.get_optimizer" href="#ActionRNNs.ExpUtils.FluxUtils.get_optimizer"><code>ActionRNNs.ExpUtils.FluxUtils.get_optimizer</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_optimizer</code></pre><p>Return the Flux optimizer given a config dictionary. The optimizer name is found at key <code>&quot;opt&quot;</code>. The parameters also change based on the  optimizer. </p><ul><li>OneParamInit: <code>eta::Float</code></li><li>TwoParamInit: <code>eta::Float</code>, <code>rho::Float</code></li><li>AdamParamInit: <code>eta::Float</code>, <code>beta::Vector</code> or <code>(beta_m::Int, beta_v::Int)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/exp_util/flux.jl#L6-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.ExpUtils.FluxUtils.RMSPropTF" href="#ActionRNNs.ExpUtils.FluxUtils.RMSPropTF"><code>ActionRNNs.ExpUtils.FluxUtils.RMSPropTF</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">RMSPropTF(η, ρ)</code></pre><p>Implements the RMSProp algortihm as implemented in tensorflow. </p><ul><li>Learning Rate (η): Defaults to <code>0.001</code>.</li><li>Rho (ρ): Defaults to <code>0.9</code>.</li><li>Gamma (γ): Defaults to <code>0.0</code>.</li><li>Epsilon (ϵ): Defaults to <code>1e-6</code></li></ul><p><strong>Examples</strong></p><p><strong>References</strong></p><p><a href="https://www.cs.toronto.edu/~tijmen/csc321/slides/lecture_slides_lec6.pdf">RMSProp</a> <a href="https://www.tensorflow.org/api_docs/python/tf/keras/optimizers/RMSprop">Tensorflow RMSProp</a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/exp_util/flux.jl#L100-L111">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ActionRNNs.ExpUtils.FluxUtils.RMSPropTFCentered" href="#ActionRNNs.ExpUtils.FluxUtils.RMSPropTFCentered"><code>ActionRNNs.ExpUtils.FluxUtils.RMSPropTFCentered</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">RMSPropTFCentered(η, ρ)</code></pre><p>Implements the Centered version of RMSProp algortihm as implemented in tensorflow. </p><ul><li>Learning Rate (η): Defaults to <code>0.001</code>.</li><li>Rho (ρ): Defaults to <code>0.9</code>.</li><li>Gamma (γ): Defaults to <code>0.0</code>.</li><li>Epsilon (ϵ): Defaults to <code>1e-6</code></li></ul><p><strong>Examples</strong></p><p><strong>References</strong></p><p><a href="https://www.cs.toronto.edu/~tijmen/csc321/slides/lecture_slides_lec6.pdf">RMSProp</a> <a href="https://www.tensorflow.org/api_docs/python/tf/keras/optimizers/RMSprop">Tensorflow RMSProp</a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mkschleg/ActionRNN.jl/blob/0cded81b34ddc9c99f9ecd33599f3ca81a7a3fa3/src/exp_util/flux.jl#L135-L146">source</a></section></article><h2 id="Misc"><a class="docs-heading-anchor" href="#Misc">Misc</a><a id="Misc-1"></a><a class="docs-heading-anchor-permalink" href="#Misc" title="Permalink"></a></h2></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« ActionRNNs.jl</a><a class="docs-footer-nextpage" href="../experiments/ringworld/">RingWorld »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.11 on <span class="colophon-date" title="Thursday 15 December 2022 13:33">Thursday 15 December 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
